"use strict";define(["common/slider/slider","site/pages/pages","site/popups/popups","site/panels/panels","./lang"],(function(e,t,n,o,i){let s,r={appendCss(e,t){let n=document.createElement("link");return self.less&&!t?(n.rel="stylesheet/less",n.href=e+".less",less.sheets.push(n),less.refresh()):(n.rel="stylesheet",n.href=e+".css"),document.head.appendChild(n)},removeCss(e){e.remove(),"stylesheet/less"===e.rel&&(less.sheets.splice(less.sheets.indexOf(e),1),less.refresh())},buildHash(e){let t="#!"+encodeURIComponent(e.id);for(let n in e.args)t+="&"+encodeURIComponent(n),void 0!==e.args[n]&&(t+="="+encodeURIComponent(e.args[n]));return t},parseHash(e){let n={id:s,args:{}},o=(e=e.substr(1).replace(/[#?].*$/,"")).match(/[^=&]+(=[^&]*)?/g);if(o&&"!"===o[0].charAt(0)){let e=decodeURIComponent(o[0].substr(1));Object.hasOwn(t,e)&&(n.id=e);for(let t=1;t<o.length;t++)e=o[t].match(/^([^=]+)(=)?(.+)?$/),e&&(n.args[decodeURIComponent(e[1])]=e[2]?decodeURIComponent(e[3]||""):void 0)}return n},isSameLocation(e,t){if(e.id===t.id&&Object.keys(e.args).length===Object.keys(t.args).length){for(let n in e.args){if(!Object.hasOwn(t.args,n))return!1;if(void 0===e.args[n]){if(e.args[n]!==t.args[n])return!1}else if(""+e.args[n]!=""+t.args[n])return!1}return!0}return!1},replaceLocation(e){r.location&&r.isSameLocation(e,r.location)?r.reloadPage():location.replace(r.buildHash(e))},getLang(e){if(navigator.languages){for(let t=0;t<navigator.languages.length;t++)if(Object.hasOwn(e,navigator.languages[t]))return e[navigator.languages[t]]}else if(Object.hasOwn(e,navigator.language))return e[navigator.language];return e.en}};return i=r.getLang(i),function(){let e="function"==typeof Symbol?Symbol("xEvents"):"xEvents";function t(t){this[e][t.type].locked=!0;for(let n=0;n<this[e][t.type].heap.length;n++)this[e][t.type].heap[n].call(this,t);for(this[e][t.type].locked=!1;this[e][t.type].stack.length;){if(this[e][t.type].stack[0])if("function"==typeof this[e][t.type].stack[0]){let n=this[e][t.type].heap.indexOf(this[e][t.type].stack[0]);n>=0&&this[e][t.type].heap.splice(n,1)}else this[e][t.type].heap.indexOf(this[e][t.type].stack[0][0])<0&&this[e][t.type].heap.push(this[e][t.type].stack[0][0]);else this[e][t.type].heap.splice(0);this[e][t.type].stack.shift()}n(this,t.type)}function n(t,n,o){!o&&t[e][n].heap.length||(delete t[e][n],t["on"+n]=null)}r.listeners={add(n,o,i){let s=0;return"function"==typeof i&&(Object.hasOwn(n,e)||(n[e]={}),Object.hasOwn(n[e],o)||(n[e][o]={stack:[],heap:[],locked:!1},n["on"+o]=t),n[e][o].locked?(n[e][o].stack.push([i]),s=2):n[e][o].heap.indexOf(i)<0&&(n[e][o].heap.push(i),s=1)),s},list(t,n){let o;if(n)o=Object.hasOwn(t,e)&&Object.hasOwn(t[e],n)?t[e][n].heap.slice(0):[];else if(o={},t[e](t,e))for(let i in t[e])o[i]=t[e][i].heap.slice(0);return o},remove(t,o,i){let s=0;if(Object.hasOwn(e))if(o){if(Object.hasOwn(t[e],o))if(t[e][o].locked)t[e][o].stack.push(i),s=2;else if("function"==typeof i){let r=t[e][o].heap.indexOf(i);r>=0&&(t[e][o].heap.splice(r,1),n(t,o),s=1)}else n(t,o,!0),s=1}else{for(let o in t[e])t[e][o].locked?(t[e][o].stack.push(void 0),s=2):n(t,o,!0);s||(s=1)}return s}}}(),function(){let e,t,n,i=document.querySelector("#panel"),s=i.querySelector(":scope>.contents>div");function l(e,o){let i,r;t=!0,o?(i=0,r="-100%",s.style.marginLeft=r):(i="-100%",r=0,s.style.marginLeft=""),s.animate([{marginLeft:i},{marginLeft:r}],{duration:200,easing:"ease-in-out"}).onfinish=function(){if(this.onfinish=null,t=!1,e(),"function"==typeof n){let e=n;n=void 0,e()}}}function u(){if("function"!=typeof o[e].onunload||!o[e].onunload())return o[e].status--,l((function(){"function"==typeof o[e].onunloadend&&o[e].onunloadend(),o[e].status--,s.querySelector(":scope>div."+e).style.display=i.style.display="",o[e].autoDestroy&&a(o[e],"panel",e),e=void 0}),!1),!0}r.openPanel=function(e,t){if(Object.hasOwn(o,e))return c("panel",o[e],e,(function(){"function"==typeof o[e].open?o[e].open(t):r.showPanel(e)})),!0},r.showPanel=function(a){let c=0;return o[a].status>1&&(t?(n=r.showPanel.bind(this,a),c=2):e?e===a?("function"==typeof o[a].onload&&o[a].onload(),"function"==typeof o[a].onloadend&&o[a].onloadend(),c=1):u()&&(n=r.showPanel.bind(this,a),c=1):(o[a].status++,"function"==typeof o[a].onload&&o[a].onload(),i.className=e=a,i.style.display=s.querySelector(":scope>div."+a).style.display="block",l((function(){"function"==typeof o[a].onloadend&&o[a].onloadend(),o[a].status++}),!0),c=1)),c},r.closePanel=function(o){let i=0;return t?(n=r.closePanel.bind(this,o),i=2):e&&(!o||e===o||Array.isArray(o)&&o.indexOf(e)>=0)&&u()&&(i=1),i},r.getCurrentPanel=function(){return e},r.destroyPanel=function(e){if(2===o[e].status)return a(o[e],"panel",e),!0},n=r.closePanel.bind(r,void 0),s.querySelector(":scope>a.close").addEventListener("click",n),i.querySelector(":scope>.mask").addEventListener("click",n),n=void 0}(),function(){let e,t=document.getElementById("popup"),o=t.querySelector(":scope>div");r.openPopup=function(e,t){if(Object.hasOwn(n,e))return c("popup",n[e],e,(function(){"function"==typeof n[e].open?n[e].open(t):r.showPopup(e)})),!0},r.showPopup=function(i){let s;return n[i].status>1&&(e?e===i?("function"==typeof n[i].onload&&n[i].onload(),s=!0):"function"==typeof n[e].onunload&&n[e].onunload()||(n[e].status--,o.querySelector(":scope>div."+e).style.display="",n[e].autoDestroy&&a(n[e],"popup",e),o.querySelector(":scope>div."+i).style.display="block",t.className=e=i,n[i].status++,"function"==typeof n[i].onload&&n[i].onload(),s=!0):(o.querySelector(":scope>div."+i).style.display=t.style.display="block",t.className=e=i,"function"==typeof r.popupEvents.onshow&&r.popupEvents.onshow({type:"show",id:e}),n[i].status++,"function"==typeof n[i].onload&&n[i].onload(),s=!0)),s},r.closePopup=function(i){let s;if(e&&(!i||e===i||Array.isArray(i)&&i.indexOf(e)>=0)&&("function"!=typeof n[e].onunload||!n[e].onunload()))return n[e].status--,s=e,o.querySelector(":scope>div."+e).style.display=t.style.display=t.className=e="",n[s].autoDestroy&&a(n[s],"popup",e),"function"==typeof r.popupEvents.onhide&&r.popupEvents.onhide({type:"hide",id:s}),!0},r.getCurrentPopup=function(){return e},r.destroyPopup=function(e){if(2===n[e].status)return a(n[e],"popup",e),!0},r.popupEvents={},t.querySelector(":scope>div>a").addEventListener("click",r.closePopup.bind(r,void 0))}(),function(){let t,n,o=document.querySelector("#photoview"),i=o.querySelector("a.close"),s=o.querySelector("a.prev"),a=o.querySelector("a.next"),l=o.querySelector("a.rotate.p"),c=o.querySelector("a.rotate.n"),u=e(o.querySelector(":scope>div")),d=[],p=[];function f(){t=self.innerWidth,n=self.innerHeight,"number"==typeof u.current&&d[u.current]&&h(u.current)}function y(e){u.children[e].addEventListener("load",(function t(){this.removeEventListener("load",t),d[e]={w:this.width,h:this.height},p[e]=0,u.current===e&&h(e);this.style.visibility="visible"}))}function h(e){let o,i,s,r,a,l=p[e]%2;l?(r=d[e].h,a=d[e].w):(r=d[e].w,a=d[e].h),r>t||a>n?(o=r/a,t/n>o?(s=n,i=s*o):(i=t,s=i/o),l?(r=s,a=i):(r=i,a=s),u.children[e].style.cursor="zoom-in"):(r=d[e].w,a=d[e].h,u.children[e].style.cursor=""),u.children[e].style.top=(n-a)/2+"px",u.children[e].style.left=(t-r)/2+"px",u.children[e].style.width=r+"px",u.children[e].style.height=a+"px",u.children[e].style.transform="rotate("+90*p[e]+"deg)"}r.showPhotoView=function(e,t){if(Array.isArray(e)){for(let t=0;t<e.length;t++){let n=document.createElement("img");n.src=e[t],u.add(n),y(t)}t>=0&&t<u.children.length&&u.slideTo(t,!0),u.children.length>1?s.style.display=a.style.display="block":s.style.display=a.style.display=""}},r.hidePhotoView=function(){for(d=[];u.children.length;)u.remove(0)},o.addEventListener("click",(function(e){if("IMG"===e.target.nodeName)if("zoom-in"===e.target.style.cursor){p[u.current]%2?(e.target.style.top=d[u.current].w>n?(d[u.current].w-d[u.current].h)/2+"px":(n-d[u.current].h)/2+"px",e.target.style.left=d[u.current].h>t?(d[u.current].h-d[u.current].w)/2+"px":(t-d[u.current].w)/2+"px"):(e.target.style.top=d[u.current].h>n?0:(n-d[u.current].h)/2+"px",e.target.style.left=d[u.current].w>t?0:(t-d[u.current].w)/2+"px"),e.target.style.width=d[u.current].w+"px",e.target.style.height=d[u.current].h+"px",e.target.style.cursor="zoom-out"}else"zoom-out"===e.target.style.cursor&&h(u.current)})),self.addEventListener("resize",f),s.addEventListener("click",(function(){u.slideTo(u.current-1)})),a.addEventListener("click",(function(){u.slideTo(u.current+1)})),l.addEventListener("click",(function(){"number"==typeof p[u.current]&&(p[u.current]++,h(u.current))})),c.addEventListener("click",(function(){"number"==typeof p[u.current]&&(p[u.current]--,h(u.current))})),i.addEventListener("click",r.hidePhotoView),u.onchange=function(){void 0===this.current?o.style.display="":(d[this.current]&&h(this.current),o.style.display="block")},"transform"in document.documentElement.style&&(l.style.display="block",c.style.display="block"),f()}(),function(){let e,t,n,o=0,s=document.querySelector("#hint"),a=document.querySelector("#readable"),l=document.querySelector("#dialog"),c=document.querySelector("#loading"),u=[];r.showLoading=function(e){c.querySelector(":scope>div>div").textContent=e||i.loading,0===o&&(c.style.display="block"),o+=1},r.hideLoading=function(){o>0&&(o-=1,0===o&&(c.style.display="","function"==typeof r.dialogEvents.onloaded&&r.dialogEvents.onloaded({type:"loaded"})))},r.isLoading=function(){return o>0},r.hint=function(t,n,o){s.className=n||"",s.querySelector("span").textContent=t,e?clearTimeout(e):(s.style.opacity=1,s.animate([{opacity:0},{opacity:1}],{duration:400,easing:"ease-in-out"})),o||(o="error"===n?4e3:"warning"===n?3e3:2e3),e=setTimeout((function(){e=0,s.style.opacity="",s.animate([{opacity:1},{opacity:0}],{duration:400,easing:"ease-in-out"})}),o)},r.showReadable=function(e,t,o,i,s){let r=a.querySelector(":scope>div");a.className=s||"",a.style.display="block",r.style.width=t,r.style.height=o,r=r.querySelector(":scope>div"),"string"==typeof e?r.innerHTML=e:r.appendChild(e),n=i},r.hideReadable=function(){"function"==typeof n&&(n(),n=void 0),a.style.display="",a.querySelector(":scope>div>div").innerHTML=""},r.hideDialog=function(e){let n;"function"==typeof t&&(n=t,t=void 0,n("isConfirm"===l.className?e:void 0)),l.className="",u.length&&(n=u.shift(),r[n.shift()].apply(r,n))},r.showForeign=function(e,t,n,o){r.showReadable('<iframe frameborder="no" allowtransparency="yes" marginwidth="0" marginheight="0" src="'+e+'"></iframe>',t,n,o,"foreign")},r.confirm=function(e,n,o){let s,r,a,c;l.className?u.push(["confirm",e,n,o]):(s=l.querySelector(":scope>div"),r=s.querySelector(":scope>div>div"),a=s.querySelector(":scope>a.yes"),c=s.querySelector(":scope>a.no"),t=n,s.style.width=o||"400px",Array.isArray(e)?(r.textContent=e[0],a.textContent=e[1],c.textContent=e[2]):(r.textContent=e,a.textContent=i.yes,c.textContent=i.no),l.className="isConfirm",s.style.height=r.offsetHeight+Math.max(a.offsetHeight,c.offsetHeight)+76+"px")},r.alert=function(e,n,o){let i,s;l.className?u.push(["alert",e,n,o]):(i=l.querySelector(":scope>div"),s=i.querySelector(":scope>div>div"),t=n,i.style.width=o||"400px",s.textContent=e,l.className="isAlert",i.style.height=s.offsetHeight+46+"px")},a.querySelector(":scope>div>a").addEventListener("click",r.hideReadable),l.querySelector(":scope>div>a.close").addEventListener("click",r.hideDialog),l.querySelector(":scope>div>a.yes").addEventListener("click",r.hideDialog.bind(r,!0)),l.querySelector(":scope>div>a.no").addEventListener("click",r.hideDialog.bind(r,!1)),r.dialogEvents={}}(),function(){let e;function n(n,o){(!n||n===e||Array.isArray(n)&&n.indexOf(e)>=0)&&(o||u(),"function"==typeof t[e].onload&&t[e].onload(!0))}function o(){let n=history.state,o=r.parseHash(location.hash);history.replaceState&&history.replaceState(!0,null),r.location&&r.isSameLocation(r.location,o)||(r.lastLocation=r.location,r.location=o,r.lastLocation&&u(),"function"==typeof r.pageEvents.onroute&&r.pageEvents.onroute({type:"route",history:n}),c("page",t[o.id],o.id,(function(i){let s;o.id!==e?(s=i||!n,e&&("function"==typeof t[e].onunload&&t[e].onunload(),t[e].status--,l("page",e).style.display="",t[e].autoDestroy&&a(t[e],"popup",activePopup)),document.body.className=e=o.id,l("page",o.id).style.display="block",t[o.id].status++,"function"==typeof t[o.id].onload&&t[o.id].onload(s)):"function"==typeof t[o.id].onload&&t[o.id].onload(),"function"==typeof r.pageEvents.onrouteend&&r.pageEvents.onrouteend({type:"routeend",history:n,force:s})})))}r.init=function(e){let n,i,a;if(Object.hasOwn(t,e))if(s){if(s!==e&&(i=s,s=e,r.location.id===i))return o(),!0}else s=e,"onhashchange"in self?self.addEventListener("hashchange",o):(setInterval((function(){n!==location.hash&&(n=location.hash,o())}),10),n=location.hash),o(),Object.hasOwn(r.location.args,"autopopup")&&(Object.hasOwn(r.location.args,"autopopuparg")&&(a=r.location.args.autopopuparg.parseJsex(),a&&(a=a.value)),r.openPopup(r.location.args.autopopup,a))},r.reloadPage=function(e,t){let o;r.isLoading()?(o=r.location,r.listeners.add(r.dialogEvents,"loaded",(function i(s){r.listeners.remove(this,s.type,i),o===r.location&&n(e,t)}))):n(e,t)},r.destroyPage=function(e){if(2===t[e].status)return a(t[e],"page",e),!0},r.pageEvents={}}(),r;function a(e,t,n){let o,i=l(t,n);i&&("function"==typeof e.ondestroy&&e.ondestroy(),i.remove(),e.js&&(o=t+"/"+n+"/"+n,require.defined(o)&&(i=require(o),require.undef(o),i&&(self.Reflect?Reflect.setPrototypeOf(e,Object.prototype):e.__proto__=Object.prototype)))),e.css&&e.css.href&&(r.removeCss(e.css),e.css=!0),delete e.status}function l(e,t){let n="#"+e;return"popup"===e?n+=">div":"panel"===e&&(n+=">.contents>div"),t&&(n+=">div."+t),document.querySelector(n)}function c(e,t,n,o){let s,c;if(t.status>1)o();else if(!t.status){t.status=1,c="page"===e,s=e+"/"+n+"/";let o=require.toUrl(s);if(t.css&&(t.css=r.appendCss(o+n)),t.html){let i=o+n+".html";fetch(i).then((o=>{if(o.ok)return o.text().then(u);a(t,e,n),BUILD&&404===o.status?p():d(i,o.status)}),(e=>d(i,e.message))).then(r.hideLoading),r.showLoading()}else u("")}function u(i){let c,u=l(e);u.insertAdjacentHTML("afterBegin",'<div class="'+n+'">'+i+"</div>"),t.js?(u.firstChild.style.visibility="hidden",r.showLoading(),r.listeners.add(r.dialogEvents,"loaded",(function e(t){r.listeners.remove(this,t.type,e),u.querySelector(":scope>div."+n).style.visibility=""})),c=s+n,require([c],(function(e){e&&(self.Reflect?Reflect.setPrototypeOf(t,e):t.__proto__=e),t.status++,o(!0),r.hideLoading()}),BUILD&&function(o){a(t,e,n),o.requireType&&"scripterror"!==o.requireType&&"nodefine"!==o.requireType||o.xhr&&404!==o.xhr.status?d(c,o.message):p(),r.hideLoading()})):(t.status++,o(!0))}function d(e,t){r.alert(i.error.replace("${res}",e)+t,c?function(){history.back()}:void 0)}function p(){c?location.reload():r.confirm(i.update,(function(e){e&&location.reload()}))}}function u(){r.closePanel(),r.closePopup(),r.hideReadable()}}));